<h1 id="why" tabindex="-1">why？ <a class="header-anchor" href="#why" aria-label="Permalink to “why？”">&#8203;</a></h1>
<p>处理音频数据，模型需要处理为16k,单声道</p>
<h1 id="so" tabindex="-1">So <a class="header-anchor" href="#so" aria-label="Permalink to “So”">&#8203;</a></h1>
<div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre><!--::markdown-it-async::xm8btal2ibhw2obcjvr1zc::--><code>import os
from pathlib import Path
from pydub import AudioSegment

# pydub处理
def convert_to_wav(src_path, dst_path, audio_format):
    sound = AudioSegment.from_file(src_path, format=audio_format).set_frame_rate(16000).set_channels(1)
    sound.export(dst_path, format=&quot;wav&quot;)

# ffmpeg处理
def cmd_convert_to_wav(src_path, dst_path):
    call = f&#039;ffmpeg -y -i &quot;{src_path}&quot; -ar 16000 -ac 1 -f wav &quot;{dst_path}&quot;&#039;
    os.system(call)


def batch_convert_to_wav(directory, filter_suffix=None, convert_suffix=None):
    filter_suffix = filter_suffix or []
    convert_suffix = convert_suffix or [&#039;.m4a&#039;, &#039;.mp3&#039;, &#039;.wav&#039;]
    directory = Path(directory)
    for file in directory.iterdir():
        if not file.is_file():
            continue
        suffix = file.suffix.lower()
        if suffix in filter_suffix or suffix not in convert_suffix:
            continue
        wav_path = file.with_suffix(&#039;.wav&#039;)
        print(f&quot;正在处理: {file}&quot;)
        try:
            convert_to_wav(str(file), str(wav_path), audio_format=suffix.lstrip(&#039;.&#039;))
        except Exception as e:
            print(f&quot;pydub转换失败: {e}，尝试ffmpeg...&quot;)
            cmd_convert_to_wav(str(file), str(wav_path))


if __name__ == &quot;__main__&quot;:
    # 音频转为wav,单声道,16k
    _dir = r&quot;&quot;
    batch_convert_to_wav(_dir, filter_suffix=[], convert_suffix=[&#039;.m4a&#039;, &#039;.mp3&#039;, &#039;.wav&#039;])</code></pre>
<div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div>